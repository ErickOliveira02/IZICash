<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Zeny - Alinhe seus propósitos</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Zeny - Alinhe seus propósitos">
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Zeny">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" href="assets/logo-icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="assets/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon-180.png">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <div class="home-brand">
                <img src="assets/logo-icon.svg" alt="Zeny" class="home-logo">
                <h1>Zeny</h1>
            </div>
            <p class="home-tagline">Alinhe seus propósitos</p>

            <!-- Form de Login -->
            <form id="loginForm">
                <input
                    type="text"
                    id="loginIdentifier"
                    placeholder="Email ou Username"
                    autocomplete="username"
                    required
                >
                <input
                    type="password"
                    id="loginPassword"
                    placeholder="Senha"
                    autocomplete="current-password"
                    required
                >
                <button type="submit" class="btn-primary">Entrar</button>
            </form>

            <div class="auth-divider">
                <span>ou</span>
            </div>

            <button class="btn-google" onclick="app.loginWithGoogle()">
                <svg width="18" height="18" viewBox="0 0 24 24">
                    <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                Entrar com Google
            </button>

            <button class="btn-link" onclick="app.showForgotPassword()">Esqueci minha senha</button>
        </div>
    </div>

    <!-- Tela de Cadastro -->
    <div id="registerScreen" class="login-screen hidden">
        <div class="login-box">
            <div class="home-brand">
                <img src="assets/logo-icon.svg" alt="Zeny" class="home-logo">
                <h1>Zeny</h1>
            </div>
            <p class="home-tagline">Alinhe seus propósitos</p>

            <form id="registerForm">
                <input
                    type="text"
                    id="registerUsername"
                    placeholder="Username (apelido)"
                    autocomplete="username"
                    required
                >
                <input
                    type="email"
                    id="registerEmail"
                    placeholder="Email"
                    autocomplete="email"
                    required
                >
                <input
                    type="password"
                    id="registerPassword"
                    placeholder="Senha (mínimo 6 caracteres)"
                    autocomplete="new-password"
                    minlength="6"
                    required
                >
                <input
                    type="password"
                    id="registerPasswordConfirm"
                    placeholder="Confirmar senha"
                    autocomplete="new-password"
                    minlength="6"
                    required
                >
                <button type="submit" class="btn-primary">Cadastrar</button>
            </form>

            <button class="btn-link" onclick="app.showLogin()">Já tenho conta</button>
        </div>
    </div>

    <!-- Tela de Recuperar Senha -->
    <div id="forgotScreen" class="login-screen hidden">
        <div class="login-box">
            <div class="logo-container">
                <img src="assets/logo-icon.svg" alt="Zeny" class="logo-icon small">
            </div>
            <h2>Recuperar Senha</h2>
            <p>Digite seu email para receber o link de recuperação</p>

            <form id="forgotForm">
                <input
                    type="email"
                    id="forgotEmail"
                    placeholder="Email"
                    autocomplete="email"
                    required
                >
                <button type="submit" class="btn-primary">Enviar Link</button>
            </form>

            <button class="btn-link" onclick="app.showLogin()">Voltar ao login</button>
        </div>
    </div>

    <!-- Tela de Verificação de Email -->
    <div id="verifyScreen" class="login-screen hidden">
        <div class="login-box">
            <div class="logo-container">
                <img src="assets/logo-icon.svg" alt="Zeny" class="logo-icon small">
            </div>
            <h2>Verifique seu Email</h2>
            <p>Enviamos um link de confirmação para:</p>
            <p class="verify-email" id="verifyEmailText">email@exemplo.com</p>
            <p class="verify-hint">Clique no link do email para ativar sua conta.</p>
            <button class="btn-secondary" onclick="app.showLogin()">Voltar ao Login</button>
        </div>
    </div>

    <!-- Tela de Criar Conta (Google OAuth) -->
    <div id="usernameScreen" class="login-screen hidden">
        <div class="login-box">
            <div class="home-brand">
                <img src="assets/logo-icon.svg" alt="Zeny" class="home-logo">
                <h1>Zeny</h1>
            </div>
            <p class="home-tagline">Alinhe seus propósitos</p>

            <form id="usernameForm">
                <div class="input-with-counter">
                    <input
                        type="text"
                        id="chooseUsername"
                        placeholder="Username"
                        autocomplete="username"
                        maxlength="20"
                        required
                        oninput="app.updateUsernameCounter()"
                    >
                    <span class="char-counter" id="usernameCounter">0/20</span>
                </div>
                <input
                    type="password"
                    id="choosePassword"
                    placeholder="Senha (mínimo 6 caracteres)"
                    autocomplete="new-password"
                    minlength="6"
                    required
                >
                <input
                    type="password"
                    id="choosePasswordConfirm"
                    placeholder="Confirmar senha"
                    autocomplete="new-password"
                    minlength="6"
                    required
                >
                <button type="submit" class="btn-primary">Criar Conta</button>
            </form>
        </div>
    </div>

    <!-- Tela Home -->
    <div id="homeScreen" class="screen hidden">
        <button class="home-menu-btn" onclick="app.openSidebar()">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="home-content">
            <div class="home-brand">
                <img src="assets/logo-icon.svg" alt="Zeny" class="home-logo">
                <h1>Zeny</h1>
            </div>
            <p class="home-tagline">Alinhe seus propósitos</p>

            <div class="home-nav">
                <button class="home-nav-btn" onclick="app.navigateTo('financas')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                    </svg>
                    <span>Finanças</span>
                </button>
                <button class="home-nav-btn" onclick="app.navigateTo('fitness')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M6.5 6.5h11M6.5 17.5h11M3 12h3m12 0h3M7.5 12a2 2 0 0 1-2-2V8.5a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2V10a2 2 0 0 1-2 2zm9 0a2 2 0 0 0 2-2V8.5a2 2 0 0 0-2-2h0a2 2 0 0 0-2 2V10a2 2 0 0 0 2 2zm-9 0a2 2 0 0 0-2 2v1.5a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V14a2 2 0 0 0-2-2zm9 0a2 2 0 0 1 2 2v1.5a2 2 0 0 1-2 2h0a2 2 0 0 1-2-2V14a2 2 0 0 1 2-2z"/>
                    </svg>
                    <span>Fitness</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Principal (Finanças) -->
    <div id="appScreen" class="hidden">
        <!-- Header -->
        <header class="header">
            <button id="appHeaderLogoBtn" class="header-logo-btn">
                <img src="assets/logo-icon.svg" alt="Zeny" class="header-logo-icon">
            </button>
            <div class="header-actions">
                <button id="settingsBtn" class="btn-settings">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    Ajustar
                </button>
            </div>
        </header>

        <!-- Tela de Setup (primeira vez) -->
        <div id="setupScreen" class="setup-screen hidden">
            <div class="setup-box">
                <h2>Configure seu primeiro bloco</h2>
                <p>Um bloco representa uma entrada de dinheiro (ex: salário dia 10)</p>

                <div class="form-group">
                    <label>Nome do bloco</label>
                    <input type="text" id="setupBlockName" placeholder="Ex: Dia 10, Salário, Freelance">
                </div>

                <div class="form-group">
                    <label>Dia de entrada (1-31)</label>
                    <input type="number" id="setupBlockDay" min="1" max="31" placeholder="Ex: 10">
                </div>

                <div class="form-group">
                    <label>Valor da entrada (R$)</label>
                    <input type="number" id="setupBlockAmount" step="0.01" placeholder="Ex: 810.00">
                </div>

                <div class="form-group">
                    <label>Limite para gastos variáveis (opcional)</label>
                    <input type="number" id="setupDailyLimit" step="0.01" placeholder="Ex: 100.00">
                </div>

                <button class="btn-primary" onclick="app.createFirstBlock()">Criar Bloco</button>
            </div>
        </div>

        <!-- Conteúdo Principal -->
        <div id="mainContent">
            <!-- Seletor de Mês -->
            <div class="month-selector">
                <button id="prevMonth">◀</button>
                <span id="currentMonth">Janeiro 2024</span>
                <button id="nextMonth">▶</button>
            </div>

            <!-- Resumo -->
            <div class="summary" id="summaryCards">
                <!-- Gerado via JS -->
            </div>

            <!-- Blocos -->
            <div class="blocks-container" id="blocksContainer">
                <!-- Gerado via JS -->
            </div>
        </div>

    </div>

    <!-- Tela Fitness -->
    <div id="fitnessScreen" class="screen hidden">
        <header class="header">
            <button id="fitnessHeaderLogoBtn" class="header-logo-btn">
                <img src="assets/logo-icon.svg" alt="Zeny" class="header-logo-icon">
            </button>
            <div class="header-actions">
                <button id="fitnessSettingsBtn" class="btn-settings">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                    Ajustar
                </button>
            </div>
        </header>

        <!-- Tabs -->
        <div class="fitness-tabs">
            <button class="fitness-tab-btn active" data-tab="workouts">Treinos</button>
            <button class="fitness-tab-btn" data-tab="diet">Dieta</button>
        </div>

        <!-- Tab: Treinos -->
        <div id="workoutsTab" class="fitness-tab-content">
            <div id="workoutsContent">
                <!-- Rendered via JS -->
            </div>
        </div>

        <!-- Tab: Dieta (placeholder) -->
        <div id="dietTab" class="fitness-tab-content hidden">
            <div class="empty-state">
                <p>Em breve...</p>
            </div>
        </div>

        <!-- FAB Criar Rotina -->
        <button id="fabCreateRoutine" class="fab-btn hidden">
            + Criar rotina
        </button>
    </div>

    <!-- Tela de Sessão Ativa -->
    <div id="activeSessionScreen" class="screen hidden">
        <header class="header">
            <button class="header-back-btn" onclick="app.exitSession()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Voltar
            </button>
            <button class="session-timer-btn" onclick="app.toggleRestTimer()">
                <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="12" cy="13" r="8"/>
                    <path d="M12 9v4l2 2"/>
                    <path d="M12 5V3"/>
                    <path d="M9 2h6"/>
                </svg>
            </button>
        </header>

        <div id="sessionContent">
            <!-- Rendered via JS -->
        </div>

        <div class="session-footer">
            <button id="finishSessionBtn" class="btn-primary btn-finish-session">
                Finalizar Treino
            </button>
        </div>
    </div>

    <!-- Modal: Adicionar Gasto -->
    <div class="modal-overlay hidden" id="addExpenseModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Adicionar Gasto</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <form id="addExpenseForm">
                    <div class="form-group">
                        <label>Bloco</label>
                        <select id="expenseBlock" required>
                            <!-- Gerado via JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Descrição</label>
                        <input type="text" id="expenseDescription" placeholder="Ex: Lanche, Uber, Café" required>
                    </div>
                    <div class="form-group">
                        <label>Valor (R$)</label>
                        <input type="number" id="expenseAmount" step="0.01" min="0.01" placeholder="0.00" required>
                    </div>
                    <button type="submit" class="btn-primary">Adicionar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Configurações -->
    <div class="modal-overlay hidden" id="settingsModal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2>Configurações</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body" id="settingsContent">
                <!-- Gerado via JS -->
            </div>
        </div>
    </div>

    <!-- Modal: Configurações Fitness -->
    <div class="modal-overlay hidden" id="fitnessSettingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Configurações</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-actions">
                    <button class="btn-setting-action" onclick="app.editRoutine()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                        Editar Rotina
                    </button>
                    <button class="btn-setting-action btn-danger-action" onclick="app.confirmDeleteRoutine()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            <line x1="10" y1="11" x2="10" y2="17"/>
                            <line x1="14" y1="11" x2="14" y2="17"/>
                        </svg>
                        Apagar Rotina
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Confirmar Apagar Rotina -->
    <div class="modal-overlay hidden" id="confirmDeleteRoutineModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Apagar Rotina?</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja apagar sua rotina de treino? Esta ação não pode ser desfeita.</p>
                <div class="modal-actions">
                    <button class="btn-danger" onclick="app.deleteRoutine()">Apagar</button>
                    <button class="btn-secondary" onclick="app.closeModal('confirmDeleteRoutineModal')">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Adicionar Gasto Fixo -->
    <div class="modal-overlay hidden" id="addFixedExpenseModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Novo Gasto Fixo</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <form id="addFixedExpenseForm">
                    <div class="form-group">
                        <label>Nome do gasto</label>
                        <input type="text" id="fixedExpenseName" placeholder="Ex: Netflix, Aluguel, Internet" required>
                    </div>
                    <div class="form-group">
                        <label>Valor (R$)</label>
                        <input type="number" id="fixedExpenseAmount" placeholder="0.00" step="0.01" min="0">
                    </div>
                    <input type="hidden" id="fixedExpenseBlockId">
                    <button type="submit" class="btn-primary">Adicionar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal: Escolher Template -->
    <div class="modal-overlay hidden" id="selectTemplateModal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2>Escolha seu Treino</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p class="modal-subtitle">Selecione um template ou crie do zero:</p>
                <div id="templatesList" class="templates-grid">
                    <!-- Rendered via JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Selecionar Dias -->
    <div class="modal-overlay hidden" id="selectDaysModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Dias de Treino</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p class="modal-subtitle">Selecione os dias que você treina:</p>
                <div class="days-selector">
                    <label class="day-checkbox">
                        <input type="checkbox" value="0"> <span>Dom</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="1"> <span>Seg</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="2"> <span>Ter</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="3"> <span>Qua</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="4"> <span>Qui</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="5"> <span>Sex</span>
                    </label>
                    <label class="day-checkbox">
                        <input type="checkbox" value="6"> <span>Sáb</span>
                    </label>
                </div>
                <button class="btn-primary" onclick="app.confirmDaysSelection()">Continuar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Adicionar Exercícios -->
    <div class="modal-overlay hidden" id="addExercisesModal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2 id="exerciseModalTitle">Segunda-feira</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <div id="exercisesList">
                    <!-- Rendered via JS -->
                </div>
                <button class="add-exercise-btn" onclick="app.openExercisePicker()">
                    + Adicionar exercício
                </button>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="app.prevDay()">Anterior</button>
                    <button class="btn-primary" onclick="app.nextDay()">Próximo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Escolher Exercício -->
    <div class="modal-overlay hidden" id="exercisePickerModal">
        <div class="modal modal-large modal-picker">
            <div class="modal-header">
                <h2>Adicionar Exercício</h2>
                <button class="modal-close" onclick="app.closeExercisePicker()">×</button>
            </div>
            <div class="modal-body">
                <div class="search-box">
                    <input type="text" id="exerciseSearch" placeholder="Buscar exercício..."
                           oninput="app.searchExercise(this.value)">
                </div>
                <div id="exerciseCategories" class="exercise-categories">
                    <!-- Rendered via JS -->
                </div>
                <div id="exerciseSearchResults" class="exercise-search-results hidden">
                    <!-- Rendered via JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Descanso (Timer 60s) -->
    <div class="modal-overlay hidden" id="restTimerModal">
        <div class="modal modal-timer">
            <div class="timer-circle">
                <svg viewBox="0 0 100 100">
                    <circle class="timer-bg" cx="50" cy="50" r="45"/>
                    <circle class="timer-progress" cx="50" cy="50" r="45" id="timerCircle"/>
                </svg>
                <span class="timer-seconds" id="timerSeconds">60</span>
            </div>
            <p class="timer-label">Descanse...</p>
            <button class="btn-secondary" onclick="app.skipRest()">Pular</button>
        </div>
    </div>

    <!-- Modal: Sair do Treino (Confirmação) -->
    <div class="modal-overlay hidden" id="confirmExitModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Sair do Treino?</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <p>O que deseja fazer com este treino?</p>
                <div class="modal-actions-vertical">
                    <button class="btn-secondary" onclick="app.closeModal('confirmExitModal')">Continuar Treino</button>
                    <button class="btn-danger" onclick="app.cancelSession()">Cancelar Treino</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Finalizar Treino Incompleto -->
    <div class="modal-overlay hidden" id="confirmFinishModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Finalizar Treino?</h2>
                <button class="modal-close" onclick="app.closeModal('confirmFinishModal')">×</button>
            </div>
            <div class="modal-body">
                <p>Você ainda não completou todos os exercícios. Deseja finalizar assim mesmo?</p>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="app.closeModal('confirmFinishModal')">Continuar</button>
                    <button class="btn-primary" onclick="app.forceFinishSession()">Finalizar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Exercício em Progresso -->
    <div class="modal-overlay hidden" id="exerciseInProgressModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Exercício em Andamento</h2>
                <button class="modal-close" onclick="app.closeModal('exerciseInProgressModal')">×</button>
            </div>
            <div class="modal-body">
                <p>Você tem um exercício em andamento. Complete todas as séries antes de iniciar outro exercício.</p>
                <div class="modal-actions">
                    <button class="btn-primary" onclick="app.closeModal('exerciseInProgressModal')">Entendi</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Parabéns -->
    <div class="modal-overlay hidden" id="congratsModal">
        <div class="modal modal-congrats">
            <div class="congrats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
            </div>
            <h2 id="congratsTitle">Parabéns!</h2>
            <p id="congratsMessage">Você completou seu treino!</p>
            <button class="btn-primary" onclick="app.closeCongratsAndReturn()">Fechar</button>
        </div>
    </div>

    <!-- Modal: Treino com Agente (Chat) -->
    <div class="modal-overlay hidden" id="agentChatModal">
        <div class="modal modal-large modal-chat">
            <div class="modal-header">
                <h2>Treino com Agente</h2>
                <button class="modal-close" onclick="app.closeAgentChat()">×</button>
            </div>
            <div class="modal-body">
                <div class="chat-container" id="agentChatContainer">
                    <!-- Messages rendered via JS -->
                </div>
                <div class="chat-input-area">
                    <input type="text" id="agentChatInput" placeholder="Digite sua resposta..."
                           onkeypress="if(event.key==='Enter')app.sendAgentMessage()">
                    <button class="btn-send" onclick="app.sendAgentMessage()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
        © 2026 Zeny. Design e desenvolvimento por <span>EJO SOFTDEV</span>
        <img src="assets/ejo-logo.png" alt="EJO SOFTDEV" class="footer-logo">
    </footer>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay hidden"></div>

    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar hidden">
        <div class="sidebar-header">
            <img src="assets/logo-icon.svg" alt="Zeny" class="sidebar-logo">
            <span class="sidebar-title">Zeny</span>
        </div>
        <ul class="sidebar-menu">
            <li data-screen="home" class="active">
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                </svg>
                Home
            </li>
            <li data-screen="financas">
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
                Finanças
            </li>
            <li data-screen="fitness">
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M6.5 6.5h11M6.5 17.5h11M3 12h3m12 0h3M7.5 12a2 2 0 0 1-2-2V8.5a2 2 0 0 1 2-2 2 2 0 0 1 2 2V10a2 2 0 0 1-2 2zm9 0a2 2 0 0 0 2-2V8.5a2 2 0 0 0-2-2 2 2 0 0 0-2 2V10a2 2 0 0 0 2 2zm-9 0a2 2 0 0 0-2 2v1.5a2 2 0 0 0 2 2 2 2 0 0 0 2-2V14a2 2 0 0 0-2-2zm9 0a2 2 0 0 1 2 2v1.5a2 2 0 0 1-2 2 2 2 0 0 1-2-2V14a2 2 0 0 1 2-2z"/>
                </svg>
                Fitness
            </li>
        </ul>
        <div class="sidebar-footer">
            <button id="sidebarLogout" class="sidebar-logout">
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                Sair
            </button>
        </div>
    </nav>

    <!-- Modal: Transferência de Saldo -->
    <div class="modal-overlay hidden" id="transferModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="transferModalTitle">Transferência de Saldo</h2>
                <button class="modal-close">×</button>
            </div>
            <div class="modal-body" id="transferModalContent">
                <!-- Gerado via JS -->
            </div>
        </div>
    </div>

    <!-- Modal: Nova Versão -->
    <div class="update-modal hidden" id="updateModal">
        <div class="update-content">
            <div class="update-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
            </div>
            <h2>Nova Versão Disponível!</h2>
            <p>Uma nova atualização está disponível.</p>
            <button class="btn-primary" onclick="location.reload(true)">Atualizar Agora</button>
            <button class="btn-later" onclick="document.getElementById('updateModal').classList.add('hidden')">Depois</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/supabase.js"></script>
    <script src="js/exercises.js"></script>
    <script src="js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    document.getElementById('updateModal')?.classList.remove('hidden');
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
